---
title: 小程序
date: 2020-06-08 09:32:09
tags:
---

## 一、小程序和h5页面的性能对比
| 类别 | 运行环境 | 开发标准 | 运行流畅度 | 发布 | 系统权限
|:------ | :------ |:------|:------|:------|:------|
|小程序|依赖微信客户端,不能操作dom|有一套自己的开发标准|流畅 |有一套发布标准 |微信能获取到更多的系统权限，如网络通信状态、数据缓存能力等，这些系统级权限都能与微信小程序无缝衔接|
|h5|在浏览器里就能运行,可以操作dom|就和写html页面一样|有卡顿的感觉 | 需要自己部署到服务器上 |少|

## 二、小程序性能优化
小程序的启动过程：
初始化小程序——下载小程序代码——加载小程序代码——初始化小程序首页
针对启动过程进行优化：
1、初始化小程序我们无法控制
2、针对下载和加载小程序代码环节，常见的控制代码包大小的方法如下：
    精简代码，清除无用代码
    减少在代码包中直接嵌入的资源文件
    图片放在cdn，使用适当的图片格式
    分包
3、针对初始化首页环节
    提前请求：在页面 onLoad 阶段就可以发起异步请求，不用等页面 ready
    善用缓存：对一些变动频率很低的异步数据进行缓存，下次启动时可以直接利用
    优化交互：在首屏渲染的期间，利用 loading 效果或展示骨架图，来缓解用户等待的焦虑
4、不要频繁调用setData,与界面渲染无关的数据最好不要设置在 data 中

## 三、小程序原理
微信小程序采用 JavaScript、WXML、WXSS 三种技术进行开发,本质就是一个单页面应用, 所有的页面更新，都需要通过对数据的更改来实现
小程序分为两个部分 webview 和 appService 。其中 webview 主要用来展现 UI ，appService 有来处理业务逻辑、数据及接口调用。它们在两个进程中运行，通过系统层 JSBridge 实现通信，实现 UI 的渲染、事件的处理

## 四、给标签设置背景图片在真机上显示不出来，开发者工具可以显示
    解决：
    1、图片使用base64
    2、使用在线图片
